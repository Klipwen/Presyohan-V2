Presyohan — Project Document
________________________________________
Table of Contents
1.	Project Title
2.	Project Purpose / Business Justification
3.	Objectives
4.	Scope
5.	Deliverables
________________________________________
1. Project Title
Presyohan — Centralized Pricing Management Web Platform
A web version of the existing Presyohan mobile app: a centralized, role-based price management system for stores to manage product prices, catalogs, and staff access.
________________________________________
2. Project Purpose / Business Justification
Summary:
Presyohan provides a centralized pricing database and store management platform so store staff always know official prices. Instead of asking co-workers for prices or maintaining multiple spreadsheets, stores can use Presyohan to publish, update, copy, import, and print price lists. The web version will mirror the mobile app’s features and add a single source of truth (Supabase backend) to support web access and administration.
Business Justification — Why this matters:
•	Reduce price confusion and human error. A single authoritative price list avoids conflicting prices across staff members and reduces customer disputes.
•	Operational efficiency. Owners can update prices quickly (CRUD, bulk import/export), reducing time spent cross-checking or calling colleagues.
•	Faster staff onboarding. New staff can quickly see the current pricelist without manual training or asking co-workers.
•	Scalability & centralization. With a centralized DB (Supabase) both mobile and web clients can read the same data; future integrations are easier.
•	Accountability & role-based control. Role-based permissions (Owner / Manager / Sale Staff) ensure only authorized users make changes.
•	Reporting & printing. Export to Excel and printing of pricelists supports operational and compliance needs.
•	Growth & cross-store operability. Ability to copy prices between stores allows rollouts of promotions or standardized pricing across branches.
Stakeholders:
•	Store Owners (primary decision makers)
•	Store Managers (admins for day-to-day)
•	Sale Staff (view-only users)
•	Store customers (indirect beneficiaries)
•	Development Team (web + backend)
•	IT/Ops (deployment & maintenance)
________________________________________
3. Objectives
3.1 High-level Objectives
1.	Create a web application that mirrors the existing mobile app’s features for pricing and store management, backed by a centralized Supabase database.
2.	Implement role-based access control (Owner, Manager, Sale Staff) enforcing view/edit permissions.
3.	Support data operations: product/category/store CRUD, bulk import/export (Excel), copy prices between stores, and price list generation for printing.
4.	Provide robust user flows to join/create stores, invite members (invite code / email), and manage members.
5.	Deliver a secure, performant, and maintainable backend using Supabase with proper authentication and policies.
3.2 Specific, Measurable Objectives
•	Implement product CRUD with timestamps and audit fields for each store by MVP release.
•	Implement category management where deleting a category cascades to delete category items (or archiving option) by MVP release.
•	Implement Store creation/join flows and invitation code generation with expiry.
•	Enable Owners to import prices via Excel (.xlsx/.csv) and export price lists to Excel within the UI.
•	Implement role-based workflows: Owners can do everything, Managers can CRUD items but cannot delete store if they are the only owner, Sale Staff have view-only access.
•	Build a mobile responsive web version, UI consistent with mobile branding (colors, logo).
•	Data migration plan to sync/migrate existing app data into the centralized Supabase schema.
3.3 Acceptance Criteria (examples)
•	A Sale Staff account can view but receives forbidden response for any edit endpoints.
•	Category deletion removes all products that reference the category (or marks them deleted if soft-delete is chosen).
•	Excel import supports mapping columns: name, description, price, unit, category name (create category if missing).
•	Invite codes can be created only by Owners and expire after configurable time; invited users can redeem a code to join a store.
•	Deleting a store is blocked if it lacks another owner; owners can leave only if another owner exists.
________________________________________
4. Scope
4.1 In-Scope (what will be built)
Core features
•	Centralized backend on Supabase (Postgres + Auth + Storage).
•	Web frontend (responsive) implementing:
o	Landing page and header/navigation.
o	Authentication (Sign-up / Sign-in via email; OAuth via Google optionally).
o	Store creation, settings, deletion/leave rules.
o	Product management: create, read, update, delete (CRUD).
o	Category management: CRUD; cascade-delete behavior documented/implemented.
o	Store member management: invite (invite code + email invitation), promote/demote/kick members, transfer ownership.
o	Role-based views & permission enforcement in front-end and backend policies.
o	Bulk import from Excel/CSV (create/update products); column mapping UI.
o	Export/pricelist -> Excel for printing; download CSV.
o	Copy prices between stores (select source store and apply to destination with conflict resolution options).
o	Notifications table & lightweight UI for membership & sharing notices (read/unread).
o	Profile settings (name, email, avatar_url).
o	Audit metadata (created_at, updated_at) visible in admin interfaces.
Data / Schema
•	Implementation of the database schema reflected in the provided ERD:
o	products (id, store_id, category_id, name, description, price, unit, created_at, updated_at)
o	categories (id, store_id, name, created_at)
o	stores (id, name, branch, type, invite_code, invite_code_created_at, created_at, updated_at)
o	app_users (id, email, name, avatar_url, created_at) linked to auth.users.id
o	store_members (store_id, user_id, role, joined_at)
o	notifications (id, receiver_user_id, sender_user_id, store_id, type, title, message, read, read_at, created_at)
•	Database policies (RLS) to enforce role-based restrictions.
Non-functional
•	Responsive UI (desktop & mobile).
•	Basic security: SSL/TLS, JWT-based auth via Supabase, RLS policies.
•	Backup strategy for Supabase/Postgres.
•	Logging for key actions (import/export, owner transfer, store deletion).
Deliverables
•	Source code (frontend & backend config), documentation, migration scripts, deployment guide, test suite (basic).
4.2 Out-of-Scope (explicitly NOT included in this phase)
•	Enterprise single-sign-on (SSO) beyond Google OAuth for MVP.
•	Mobile app changes — mobile app remains unchanged in this phase except possible migration guidance/data export.
•	Real-time collaboration (live editing) — updates are eventual / near-real-time via DB subscriptions if implemented later.
________________________________________
5. Deliverables
This section lists the tangible outputs the project will deliver, with detail for each deliverable.
5.1 Functional Deliverables
5.1.1 Authentication & User Management
•	Email/password authentication integrated with Supabase Auth (and optional Google OAuth).
•	User profile page: name, email (read-only if from OAuth), avatar_url, created_at.
•	Link between app_users.id and auth.users.id.
•	Password reset flow.
5.1.2 Store Management
•	Create Store: name, branch, type (e.g., retail, kiosk), generates invite_code (unique) and invite_code_created_at.
•	Store Settings: edit name/branch/type, regenerate invite code, set invite expiry.
•	Delete Store: only allowed if there is another owner; otherwise block and require transfer of ownership.
•	Leave Store: allowed for Managers and Sale Staff; Owners can leave only if another owner exists.
5.1.3 Member & Role Management
•	store_members management UI:
o	Invite member by generating invite codes or by sending invitation to an email (preferably using in-app invite if email belongs to registered user).
o	Promote / Demote members between owner, manager, sale_staff.
o	Remove user from store.
o	Transfer owner role (promote a manager to owner, but owner cannot demote another owner).
•	Invite redemption flow: user signs in, redeems invite code; store_members entry created with role (configurable—usually sale_staff or manager).
5.1.4 Products (Items) Management
•	Product CRUD per store:
o	Fields: id, store_id, category_id (nullable), name, description, price (numeric), unit, created_at, updated_at.
•	Bulk operations:
o	Import prices from Excel/CSV into selected store: mapping UI, preview, validate duplicates, choose update strategy (overwrite, skip).
o	Copy prices from one store to another: with a preview & conflict resolution.
o	Export pricelist to Excel (xlsx) for printing and record-keeping.
•	Category delete cascade behavior: deleting a category will delete associated products (or optionally soft-delete / reassign — document choice).
5.1.5 Categories Management
•	Category CRUD per store:
o	Fields: id, store_id, name, created_at.
•	Deleting category removes associated products (cascade delete) — the UI confirms this destructive action.
5.1.6 Notifications
•	Basic notifications stored in notifications table for events like:
o	Invitation sent
o	Invite redeemed
o	Member promotion/demotion
o	Pricelist imported
•	Notification fields: id, receiver_user_id, sender_user_id, store_id, type, title, message, read (bool), read_at, created_at.
•	Notification UI (bell icon in header) shows unread count, click to view.
5.1.7 Search & Filtering
•	Search products by name, category, unit.
•	Filtering by price range, category, or last updated.
•	Sort by name/price/last updated.
5.1.8 Landing Page & Header
•	Responsive landing page with sections:
o	Header: Logo, nav links (Home, About, Feature, Download App, Contact Us, Sign Up, Login,).
o	Hero section: headline, subheadline, CTA buttons.
o	About, Features, Testimonials, CTA, Footer.
5.1.9 Audit & Logs
•	Record created_at and updated_at on major tables.
•	Activity log for admin-level actions (imports, ownership changes).
5.2 Data Model & Schema Deliverables
•	Supabase schema implementing the ERD shown in the provided image:
o	products, categories, stores, app_users, store_members, notifications.
•	RLS (Row-Level Security) policies:
o	Only members of a store can read that store’s products.
o	Only Managers and Owners can write (create/update/delete) products in a store.
o	Only Owners can delete store or transfer ownership.
o	Sale Staff: read-only privileges.
Table field details (from ERD, expanded)
•	products
o	id (uuid, PK)
o	store_id (uuid, FK -> stores.id)
o	category_id (uuid, FK -> categories.id, nullable)
o	name (text)
o	description (text)
o	price (numeric)
o	unit (text)
o	created_at (timestamp)
o	updated_at (timestamp)
•	categories
o	id (uuid, PK)
o	store_id (uuid, FK -> stores.id)
o	name (text)
o	created_at (timestamp)
•	stores
o	id (uuid, PK)
o	name (text)
o	branch (text)
o	type (text)
o	invite_code (text)
o	invite_code_created_at (timestamp)
o	created_at (timestamp)
o	updated_at (timestamp)
•	app_users
o	id (uuid, PK) — linked to auth.users.id
o	email (text)
o	name (text)
o	avatar_url (text)
o	created_at (timestamp)
•	store_members
o	store_id (uuid, FK)
o	user_id (uuid, FK -> app_users.id)
o	role (text) — values: owner, manager, sale_staff
o	joined_at (timestamp)
•	notifications
o	id (uuid, PK)
o	receiver_user_id (uuid)
o	sender_user_id (uuid)
o	store_id (uuid)
o	type (text)
o	title (text)
o	message (text)
o	read (bool)
o	read_at (timestamp)
o	created_at (timestamp)
5.3 Technical Deliverables
•	Frontend codebase with:
o	Responsive UI components, routing, state management (brief usage doc).
o	Import/export components for Excel (client-side parsing + server endpoint).
•	Backend configuration and functions (Supabase):
o	Database schema & migration scripts.
o	RLS policies and SQL functions (e.g., mass_import_products, copy_prices).
o	Cloud function(s) / server endpoints if necessary (e.g., for heavy processing for import).
•	Documentation:
o	README with setup instructions.
o	API / Endpoints documentation (if any server functions are used).
o	ERD diagram and schema explanation.
o	Admin guide for store owners (how to manage users, import/export).
•	Tests:
o	Basic unit & integration tests for critical flows: auth, import, role enforcement, invite redemption.
•	Migration utilities:
o	Scripts to export existing mobile app data and import into Supabase schema (map fields).
•	Backup & Recovery plan documentation.
5.4 UX & UI Deliverables
•	Style guide: colors (matching mobile app), typography, spacing rules.
•	Wireframes for key pages: Stores Page, Store Settings, Product List, Product Edit, Import/Export modal, Member management, Invite flows.
•	High-fidelity mockups (desktop & mobile breakpoints).
5.5 Security & Operations
•	Security config:
o	RLS policies and least-privilege roles.
o	Secure invite code handling and expiry.
o	Input validation for import functionality to avoid injection or corrupting DB.
•	Operations:
o	Backup schedule (daily/weekly).
o	Monitoring guidance (Supabase metrics + sentry or logs).
o	Data retention & GDPR/privacy notes (depending on jurisdiction).
5.6 Acceptance & Handover
•	Acceptance test checklist for stakeholders.
•	Final handover package: source code, credentials list (securely), documentation, and a demo deployment URL.
________________________________________
Additional Notes & Recommendations (detailed)
Data Deletion Policy for Categories & Products
•	Hard delete cascade: if category is deleted, delete all products for that category. (Simple but irreversible.)
Import/Export Rules
•	Import validation: Before committing, show preview with:
o	rows to create vs rows to update
o	validation errors (bad price format, missing name)
o	mapping preview (CSV column -> DB field)
•	Duplicates strategy: let user choose per import:
o	Overwrite existing by name
o	Skip duplicates
o	Append with unique suffix
•	Excel formatting:
o	Accept headers: name, description, price, unit, category.
o	For large files, consider server-side processing (upload file -> background job -> notify on completion) to avoid browser timeouts.
Invite Flow Variants
•	Invite Code:
o	Owner generates code and shares manually.
o	Code has expiry and single-use or multi-use option.
•	Invite by Email:
o	If target email is registered in app_users, create store_members entry and send notification.
Ownership Transfer
•	Implement explicit “Transfer Ownership” flow:
o	Current owner selects a manager to promote to owner.
o	System logs the transfer and notifies both parties.
Permissions Summary (quick reference)
•	Owner
o	Full CRUD on products, categories, store settings.
o	Manage members (promote/demote/remove) and transfer ownership.
o	Delete store (only if other owner exists or require confirmation).
•	Manager
o	CRUD items and categories.
o	May leave store.
•	Sale Staff
o	View-only.
o	May leave store.
•	User (global)
o	Create store, update own profile, join store via invite.
Migration from Existing App
•	Export from mobile app existing stores/products/users into CSV/JSON.
•	Create mapping script to import into stores, categories, products, app_users, store_members.
•	Validate owners transfer and membership roles.
•	Communicate planned migration window to users and freeze writes during migration to avoid conflicts.
Performance, Scaling & Limits
•	Use index on products.store_id, products.category_id, stores.id.
•	Consider pagination for product lists and server-side filtering for large stores.
•	For extremely large imports, process asynchronously.
________________________________________
Project Risks & Mitigations
•	Risk: Import overwrites production data accidentally.
Mitigation: Preview step, soft-delete option, and transactional imports with rollback.
•	Risk: Unauthorized edits due to improper RLS.
Mitigation: Strict RLS testing, unit tests, code review before deployment.
•	Risk: Invitation codes leaked/abused.
Mitigation: Short expiry default and ability to revoke/regenerate codes.
•	Risk: Data inconsistency across old mobile app and new centralized DB.
Mitigation: Migration plan with freeze window, verification scripts, and rollback plan.

